[
  {
    "objectID": "cell_clustering.html",
    "href": "cell_clustering.html",
    "title": "QC and Cell-level filtering",
    "section": "",
    "text": "library(Seurat)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(patchwork)\nlibrary(stringr)\nlibrary(ggplot2)\n\nLoading required package: SeuratObject\n\nLoading required package: sp\n\n\nAttaching package: ‘SeuratObject’\n\n\nThe following object is masked from ‘package:base’:\n\n    intersect\n\n\n\nAttaching package: ‘dplyr’\n\n\nThe following objects are masked from ‘package:stats’:\n\n    filter, lag\n\n\nThe following objects are masked from ‘package:base’:\n\n    intersect, setdiff, setequal, union\nseurat_obj_ls &lt;- \n    lapply(c('iso-F-04','iso-F-22','iso-F-35','iso-M-00','iso-M-23','iso-M-40','soc-F-05','soc-F-24','soc-F-36','soc-M-01','soc-M-25','soc-M-41'),\n       function(x){\n           cell.use &lt;- read.csv(paste0(\"./samples/\",x,\".Rat.allCells.csv\"))%&gt;% \n            filter(pass==\"True\") %&gt;%\n            pull(X)\n        Read10X(paste0(\"alignment/\",x,\".Rat/\",x,\".Rat.star.solo/GeneFull_Ex50pAS/raw/\")) %&gt;%\n           CreateSeuratObject(project = \"Rat\", min.cells = 3, min.features = 200) %&gt;%       \n            subset(cells = cell.use)\n           })\n\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nWarning message:\n“Feature names cannot have underscores ('_'), replacing with dashes ('-')”\nSeurat_merged &lt;- merge(seurat_obj_ls[[1]],seurat_obj_ls[-1],project=\"Rat\",\n                       add.cell.ids =c('iso-F-04','iso-F-22','iso-F-35','iso-M-00','iso-M-23','iso-M-40','soc-F-05','soc-F-24','soc-F-36','soc-M-01','soc-M-25','soc-M-41'))\nSeurat_merged\n\nAn object of class Seurat \n26597 features across 76385 samples within 1 assay \nActive assay: RNA (26597 features, 0 variable features)\n 12 layers present: counts.1, counts.2, counts.3, counts.4, counts.5, counts.6, counts.7, counts.8, counts.9, counts.10, counts.11, counts.12\nSeurat_merged[[\"RNA\"]] &lt;-JoinLayers(Seurat_merged[[\"RNA\"]])\nSeurat_merged\n\nAn object of class Seurat \n26597 features across 76385 samples within 1 assay \nActive assay: RNA (26597 features, 0 variable features)\n 1 layer present: counts\n# The [[ operator can add columns to object metadata. This is a great place to stash QC stats\nSeurat_merged[[\"percent.mt\"]] &lt;- PercentageFeatureSet(Seurat_merged, pattern = \"^Mt-\")\noptions(repr.plot.width = 10, repr.plot.height = 5, repr.plot.res = 300)\n# Visualize QC metrics as a violin plot\np1 &lt;- VlnPlot(Seurat_merged, features = c(\"nFeature_RNA\", \"nCount_RNA\"), ncol = 3,layer='counts')\np1\nobj &lt;- subset(Seurat_merged, subset = nFeature_RNA &gt; 200 & nFeature_RNA &lt; 4000)\nobj\n\nAn object of class Seurat \n26597 features across 76089 samples within 1 assay \nActive assay: RNA (26597 features, 0 variable features)\n 1 layer present: counts"
  },
  {
    "objectID": "cell_clustering.html#normalizing-the-data",
    "href": "cell_clustering.html#normalizing-the-data",
    "title": "QC and Cell-level filtering",
    "section": "Normalizing the data",
    "text": "Normalizing the data\n\nobj &lt;- SCTransform(obj, vst.flavor = 'v2', verbose = FALSE) \n\n\nobj &lt;- obj %&gt;%\n    RunPCA(npcs = 30, verbose = FALSE,features = VariableFeatures(object = obj))\n\n\nVizDimLoadings(obj, dims = 1:2, reduction = \"pca\")\n\n\n\n\n\n\n\n\n\noptions(repr.plot.width = 10, repr.plot.height = 8, repr.plot.res = 300)\nDimHeatmap(obj, dims = 1:9, cells = 500, balanced = TRUE)\n\n\n\n\n\n\n\n\n\noptions(repr.plot.width = 5, repr.plot.height = 4, repr.plot.res = 300)\nElbowPlot(obj)"
  },
  {
    "objectID": "cell_clustering.html#cell-clustering",
    "href": "cell_clustering.html#cell-clustering",
    "title": "QC and Cell-level filtering",
    "section": "cell clustering",
    "text": "cell clustering\n\nobj\n\nAn object of class Seurat \n52115 features across 76089 samples within 2 assays \nActive assay: SCT (25518 features, 3000 variable features)\n 3 layers present: counts, data, scale.data\n 1 other assay present: RNA\n 1 dimensional reduction calculated: pca\n\n\n\nobj &lt;- AddMetaData(\n  object = obj,\n  metadata = stringr::str_split(row.names(obj@meta.data),\"-\",simplify=T)[,1],\n  col.name = 'group'\n)\n\nobj &lt;- AddMetaData(\n  object = obj,\n  metadata = stringr::str_split(row.names(obj@meta.data),\"-\",simplify=T)[,2],\n  col.name = 'sex'\n)\n\n\nhead(obj@meta.data)\n\n\nA data.frame: 6 × 8\n\n\n\norig.ident\nnCount_RNA\nnFeature_RNA\npercent.mt\nnCount_SCT\nnFeature_SCT\ngroup\nsex\n\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;int&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\niso-F-04_AAACCATAGACTATGCAATACCAGGCGCA\nRat\n2892\n1519\n0\n3229\n1519\niso\nF\n\n\niso-F-04_AAACCATAGACTATGCAATTCGGATTCGG\nRat\n2971\n1489\n0\n3287\n1489\niso\nF\n\n\niso-F-04_AAACCATAGGGTATGCTTGTCGGATTCGG\nRat\n1996\n1189\n0\n3028\n1208\niso\nF\n\n\niso-F-04_AAACCATAGTCCTACCAGTCTAACTAGGT\nRat\n5871\n2496\n0\n4299\n2456\niso\nF\n\n\niso-F-04_AAACCATAGTCCTACCAGTGTAGGATAAG\nRat\n2068\n1185\n0\n3104\n1190\niso\nF\n\n\niso-F-04_AAACCATAGTCGCGGTTGGTTGATACGAT\nRat\n1922\n1121\n0\n3064\n1153\niso\nF\n\n\n\n\n\n\nobj &lt;- obj %&gt;%\n        FindNeighbors(reduction = \"pca\", dims = 1:15, verbose = FALSE) %&gt;%\n        FindClusters(resolution = 0.7, verbose = FALSE) %&gt;%\n        RunUMAP(reduction = \"pca\", dims = 1:15, verbose = FALSE)\n\nWarning message:\n“The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric\nTo use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'\nThis message will be shown once per session”\nFound more than one class \"dist\" in cache; using the first, from namespace 'spam'\n\nAlso defined by ‘BiocGenerics’\n\nFound more than one class \"dist\" in cache; using the first, from namespace 'spam'\n\nAlso defined by ‘BiocGenerics’\n\n\n\n\nobj\n\nAn object of class Seurat \n52115 features across 76089 samples within 2 assays \nActive assay: SCT (25518 features, 3000 variable features)\n 3 layers present: counts, data, scale.data\n 1 other assay present: RNA\n 2 dimensional reductions calculated: pca, umap"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ScaleBio run on rat brain tissues from social isolation study",
    "section": "",
    "text": "Lin Yang\n\n\nThree replicates for female and male rat treated with social isolation and social grouped respectively are included in the experiment. The treatment was exerted from p41-p55. Then, orbitofrontal cortex are dissected from frozen brain tissues and Hang did the nuclei preparation and library preparation with ScaleBio RNA-seq kit.\nA relavant presentation for this project is available at: presentation\n\n\n\n\ndata preprocess\n\nThe library sequencing was ran on Illumina sequencer and demultiplexed by i5 barcode by the sequencing core in UofC. Four .fastq files are returned from the core:\nUndetermined_S0_L002_I1_001.fastq.gz: i7 index Undetermined_S0_L002_I2_001.fastq.gz: i5 index Undetermined_S0_L002_R1_001.fastq.gz: reads1, recording barcode sequences Undetermined_S0_L002_R2_001.fastq.gz: reads2, recording cDNA sequences\nThe data preprocessing are implemented with pipeline from ScaleBio with the command:\nmodule load singularity\nnextflow run /project/zhuzhuzhang/lyang/software/ScaleRna/ -params-file runParams.yml -profile singularity --outDir /project/zhuzhuzhang/lyang/scaleBio_RNA_rat_brain/out_mRatBN —-splitFastq true\ninputs:\nrunParams.yml\noutputs:\nquality control (/project/zhuzhuzhang/lyang/scaleBio_RNA_rat_brain/out_mRatBN/samples)\ncell by feature matrix (/project/zhuzhuzhang/lyang/scaleBio_RNA_rat_brain/out_mRatBN/alignment)\n\ncell clustering\n\nCell clustering was perform in R with Seurat package"
  },
  {
    "objectID": "index.html#project-description",
    "href": "index.html#project-description",
    "title": "ScaleBio run on rat brain tissues from social isolation study",
    "section": "",
    "text": "Three replicates for female and male rat treated with social isolation and social grouped respectively are included in the experiment. The treatment was exerted from p41-p55. Then, orbitofrontal cortex are dissected from frozen brain tissues and Hang did the nuclei preparation and library preparation with ScaleBio RNA-seq kit.\nA relavant presentation for this project is available at: presentation"
  },
  {
    "objectID": "index.html#data-processing-steps",
    "href": "index.html#data-processing-steps",
    "title": "ScaleBio run on rat brain tissues from social isolation study",
    "section": "",
    "text": "data preprocess\n\nThe library sequencing was ran on Illumina sequencer and demultiplexed by i5 barcode by the sequencing core in UofC. Four .fastq files are returned from the core:\nUndetermined_S0_L002_I1_001.fastq.gz: i7 index Undetermined_S0_L002_I2_001.fastq.gz: i5 index Undetermined_S0_L002_R1_001.fastq.gz: reads1, recording barcode sequences Undetermined_S0_L002_R2_001.fastq.gz: reads2, recording cDNA sequences\nThe data preprocessing are implemented with pipeline from ScaleBio with the command:\nmodule load singularity\nnextflow run /project/zhuzhuzhang/lyang/software/ScaleRna/ -params-file runParams.yml -profile singularity --outDir /project/zhuzhuzhang/lyang/scaleBio_RNA_rat_brain/out_mRatBN —-splitFastq true\ninputs:\nrunParams.yml\noutputs:\nquality control (/project/zhuzhuzhang/lyang/scaleBio_RNA_rat_brain/out_mRatBN/samples)\ncell by feature matrix (/project/zhuzhuzhang/lyang/scaleBio_RNA_rat_brain/out_mRatBN/alignment)\n\ncell clustering\n\nCell clustering was perform in R with Seurat package"
  }
]